# 正则表达式(BRE)
![](pics3/reg.jpg)

正则表达式的特殊字符（元字符）
![](pics3/reg2.jpg)
非特殊字符与自身匹配
![](pics3/reg3.jpg)
一个集合只能匹配其内范围中的一个字符
![](pics3/reg4.jpg)
![](pics3/reg5.jpg)
![](pics3/reg6.jpg)
![](pics3/reg7.jpg)

![](pics3/reg8.jpg)
最后一个中1,$表示范围是第一行（1）到最后一行（ $），[0-9]*表示匹配0个或多个数字（推荐换成+，表示匹配至少一个字符），然后替换(s)成xx，最后的g表示全部替换,/用于分隔，也可换成其他字符，如^

![](pics3/reg9.jpg)
^ 在首部时有特殊含义，表示从句首开始匹配，否则匹配^字符（即自身）

vim中使用:`10,50s/^    //g `
表示删除10-50行中每一行行首的四个空格

# 正则表达式扩展(ERE)
![](pics3/ere1.jpg)
![](pics3/ere2.jpg)

# 与BRE相关的命令
![](pics3/grep.jpg)
stream editor  
一般都是逐行匹配

## grep
grep:global regular expression print
![](pics3/grep2.jpg)
![](pics3/grep3.jpg)
![](pics3/grep4.jpg)
![](pics3/grep5.jpg)
![](pics3/grep6.jpg)
匹配顶格为d的行，d(directory)表示目录，-表示文本文件，l(link)表示链接，c(char)表示字符设备文件
>字母“-”表示该文件是一个普通文件  
字母“d”表示该文件是一个目录，字母"d"，是dirtectory(目录)的缩写  
注意：目录或者是特殊文件，这个特殊文件存放其他文件或目录的相关信息  
字母“l”表示该文件是一个链接文件。字母"l"是link(链接)的缩写，类似于windows下的快捷方式  
字母“b”的表示块设备文件(block)，一般置于/dev目录下，设备文件是普通文件和程序访问硬件设备的入口，是很特殊的文件。没有文件大小，只有一个主设备号和一个辅设备号。一次传输数据为一整块的被称为块设备，如硬盘、光盘等。最小数据传输单位为一个数据块(通常一个数据块的大小为512字节)  
字母为“c”表示该文件是一个字符设备文件(character)，一般置于/dev目录下，一次传输一个字节的设备被称为字符设备，如键盘、字符终端等，传输数据的最小单位为一个字节。  
字母为“p”表示该文件为命令管道文件。与shell编程有关的文件。  
字母“s”表示该文件为sock文件。与shell编程有关的文件。

## sed
stream editor 流编辑，正则表达式替换
![](pics3/sed2.jpg)
![](pics3/sed.jpg)
tail -f 可以持续输入一个文件新追加的内容，通过管道命令|作为输入给sed，后面命令中使用/分隔(也可换成其他字符)，s表示替换，中间正则表达式匹配一个ip地址，然后替换成桥西，g表示全部替换
![](pics3/sed3.jpg)
分组操作  
`cat test.c | sed 's/\([a-zA-Z_][a-zA-Z1-9_]*\)->number/\1->num/g'`<br>
>读取文件内容，通过管道传给sed处理  
([a-zA-Z_][a-zA-Z1-9_]*)->number,表示匹配字母下划线开头，其余为字母数字下划线（即标识符的格式）的一个标识符，之后跟->number的pattern。将其分为一个组,使用`\(`和`\)`分组。然后每一行（g）中匹配到的pattern都替换（s-substitute）成标识符->num格式，这里\1表示第一组的内容

![](pics3/sed4.jpg)
![](pics3/sed5.jpg)

## awk
![](pics3/awk.jpg)
![](pics3/awk2.jpg)
条件可使用关系运算符(如>=)，逻辑运算符(如&&)，/regexpr/正则表达式匹配
![](pics3/awk3.jpg)
![](pics3/awk4.jpg)
匹配带有python的行，指定格式输出第二列($2)
![](pics3/awk5.jpg)
NR表示行数，{}左边表示条件（`$1>100`即第一列数值大于100执行动作），{}内在条件满足时执行  
$n即第n列，$0表示该行全部内容
BEGIN {}； END {}可作为条件，在刚开始或全部处理完后执行某些操作

## 示例1 文本词频统计
`cat test.txt | tr '[A-Z]' '[a-z]' |  tr '%.-_()/={}\47?#,+--"*&' ' ' | tr ' ' '\012' | grep -v '^ *$' | sort | uniq -c | sort -n | tail -n 10`<br>
读取一个英文文本文件<br>
`tr '[A-Z]' '[a-z]'`将大写字母变成小写<br>
`tr '%.-_()/={}\47?#,+--"*&' ' '`将这些标点符号替换成空格，即删掉所有标点，第二个参数不能是空字符串<br>
`tr ' ' '\012'` 将空格换成换行，单引号的8进制ascii码为047，换行为012。此时文件内容变为单词或空格为单独一行
![](pics3/od.jpg)
`grep -v '^ *$'` 匹配开头(^)到结尾($)都为空格( *)的行，然后输出不符合该pattern的行，即输出非空行，此时只剩下单词<br>
sort 按字符顺序排序  
uniq -c 去重，并输出重复次数(第一列)和文本(第二列)  
sort -n 按第一列数值升序排序  
tail -n 10 输出最后10行
![](pics3/sort.jpg)

## 示例2 html文件提取信息
![](pics3/wget.jpg)
wget 保存给定url上的资源  
`cat 821351.html | sed -e 's/<[^<>]*>/ /g'` 将<>标签删除，其中[^<>]表示内部不匹配<>，即非贪婪匹配
![](pics3/awk6.jpg)
awk -f file.awk 执行上面的条件和命令  
sz 821351.html 可将文件保存到本机上
